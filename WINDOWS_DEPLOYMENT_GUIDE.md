# 公司管理系统 - Windows 部署与使用指南

## 概述

本文档为 **Windows 用户** 提供了一套完整、简化的部署和使用方案。通过一键式脚本，您可以轻松地在 Windows 服务器上部署管理系统，并为其他电脑构建桌面客户端。

### 核心优势

-   **一键安装**：通过 `安装部署.bat` 脚本自动完成环境检查、依赖安装和项目构建。
-   **可视化配置**：无需手动编辑 JSON 文件，通过浏览器访问 `http://服务器IP:端口/admin` 即可修改服务器配置。
-   **便捷启动**：双击 `启动服务器.bat` 即可运行服务器。
-   **客户端构建**：通过 `构建客户端.bat` 脚本，可轻松生成安装版和便携版的 Windows 客户端程序。

---

## 第一部分：服务器部署 (Windows)

请在您的 Windows 服务器上按照以下步骤操作。

### 部署环境要求

-   **操作系统**：Windows 10 / Windows Server 2016 或更高版本。
-   **运行环境**：**Node.js** (版本 16.x 或更高)。脚本会自动检查，若未安装会提示您下载。

### 部署步骤

#### 步骤 1：上传并解压项目

将 `glance-company-insight-v3-windows.zip` 压缩包上传到服务器，并解压到一个固定的位置（例如 `D:\CompanySystem`）。

#### 步骤 2：一键安装部署

双击项目根目录下的 **`安装部署.bat`** 文件。脚本将自动执行以下操作：

1.  检查 Node.js 环境。
2.  安装所有必需的项目依赖。
3.  构建前端应用程序。

整个过程可能需要几分钟，请耐心等待。安装完成后，脚本会提示您是否立即启动服务器。

#### 步骤 3：启动服务器

双击项目根目录下的 **`启动服务器.bat`** 文件。服务器启动后，会显示访问地址和配置界面的信息。

> **注意**：请保持此命令行窗口运行，关闭窗口将导致服务器停止服务。

#### 步骤 4：可视化配置服务器

1.  在服务器的浏览器中，访问 `http://localhost:3000/admin`。
2.  您会看到一个可视化的配置界面，可以在此修改**服务器端口**、**注册邀请码**等信息。
3.  修改后点击 **“保存配置”**。
4.  **重启服务器**（关闭 `启动服务器.bat` 窗口再重新双击打开）使新配置生效。

| 配置项 | 说明 |
| :--- | :--- |
| `监听端口` | 服务器运行的端口，客户端将通过此端口访问。 |
| `监听地址` | 默认 `0.0.0.0`，允许局域网内其他计算机访问。 |
| `注册邀请码` | 新用户注册时必须提供的邀请码。 |

#### 步骤 5：配置防火墙

如果您的服务器开启了防火墙（例如 Windows Defender 防火墙），请务必**添加入站规则**，允许您配置的端口（默认为 `3000`）的 TCP 连接，否则其他电脑将无法访问。

---

## 第二部分：桌面客户端构建与使用 (Windows)

您可以为公司内部的其他 Windows 电脑构建专属的桌面客户端。

### 构建客户端步骤

1.  进入项目文件夹中的 `client-app` 目录。
2.  双击 **`构建客户端.bat`** 文件。
3.  根据提示选择构建 **安装版** 或 **便携版**。
4.  构建成功后，会在 `client-app\dist` 目录下找到生成的 `.exe` 文件。

### 客户端使用

1.  将生成的客户端程序（安装版或便携版）分发给需要访问系统的员工。
2.  员工首次打开客户端时，程序会引导其输入服务器地址。
    -   格式为：`http://<服务器的IP地址>:<端口>`
    -   例如：`http://192.168.1.10:3000`
3.  输入地址并勾选“记住服务器地址”后，点击“连接服务器”。
4.  后续打开客户端将自动连接到已保存的服务器地址。

---

## 数据管理

-   **数据存储**：所有用户和项目数据都以 JSON 文件的形式存储在服务器的 `server\data` 目录中。
-   **数据备份**：请定期备份 `server\data` 文件夹以防数据丢失。
